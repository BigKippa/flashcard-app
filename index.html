
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Flashcard App – Prepositions of Time</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2rem;
      background: #f9f9f9;
      color: #333;
    }
    .question {
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }
    .option {
      display: block;
      width: 100%;
      padding: 0.75rem;
      margin: 0.5rem 0;
      font-size: 1rem;
      cursor: pointer;
    }
    .green {
      background-color: #c8e6c9;
    }
    .red {
      background-color: #ffcdd2;
    }
    .bottom {
      margin-top: 2rem;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <h1>Prepositions of Time – Beginner Flashcards</h1>
  <div id="app">Loading...</div>

  <script>
    let flashcards = [];
    let current = 0;
    let scoreCorrect = 0;
    let scoreIncorrect = 0;
    let incorrectAnswers = [];

    fetch("prepositions_time_beginner_100.json")
      .then(res => res.json())
      .then(data => {
        flashcards = data;
        renderCard();
      })
      .catch(err => {
        console.error("Failed to load flashcards:", err);
        document.getElementById("app").innerHTML = "<p>Failed to load flashcards.</p>";
      });

    function renderCard() {
      const card = flashcards[current];
      const app = document.getElementById("app");
      app.innerHTML = `
        <div class="question">${card.question}</div>
        ${card.options.map(opt => `<button class="option" onclick="checkAnswer(this, '${opt}', '${card.correct}')">${opt}</button>`).join("")}
        <div class="bottom">Card ${current + 1} of ${flashcards.length} | ✅ ${scoreCorrect} ❌ ${scoreIncorrect}</div>
      `;
    }

    function checkAnswer(button, selected, correct) {
      const buttons = document.querySelectorAll(".option");
      buttons.forEach(btn => btn.disabled = true);
      if (selected.toLowerCase() === correct.toLowerCase()) {
        button.classList.add("green");
        scoreCorrect++;
      } else {
        button.classList.add("red");
        scoreIncorrect++;
        incorrectAnswers.push({ question: flashcards[current].question, selected, correct });
      }
      setTimeout(() => {
        current++;
        if (current < flashcards.length) {
          renderCard();
        } else {
          showResults();
        }
      }, 800);
    }

    function showResults() {
      const percent = Math.round((scoreCorrect / flashcards.length) * 100);
      const missed = incorrectAnswers.map(item => `
        <li><strong>Q:</strong> ${item.question}<br>
        ❌ Your answer: ${item.selected}<br>
        ✅ Correct answer: ${item.correct}</li>`).join("");
      document.getElementById("app").innerHTML = `
        <h2>Deck Complete!</h2>
        <p>Score: ${scoreCorrect}/${flashcards.length} (${percent}%)</p>
        <h3>Incorrect Answers</h3>
        <ul>${missed || "<li>No missed questions – great job!</li>"}</ul>
        <button onclick="location.reload()">Restart</button>
      `;
    }
  </script>
</body>
</html>
